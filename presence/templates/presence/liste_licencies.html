{% extends "presence/base.html" %}

{% block title %}Liste des licenci√©s{% endblock %}

{% block content %}
<div class="container">
    <div class="header-row" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
        <h2>üë• Liste des licenci√©s</h2>
        <div>
            <a href="{% url 'ajouter_licencie' %}" class="btn-submit" style="margin-right: 10px;">‚ûï Ajouter</a>
            <a href="{% url 'export_licencies_excel' %}" class="btn-submit">üì• Exporter vers Excel</a>
        </div>
    </div>

    {% if licencies %}
        <table class="styled-table">
            <thead>
                <tr>
                    <th style="width: 18%;">Nom</th>
                    <th style="width: 18%;">Pr√©nom</th>
                    <th>Grade</th>
                    <th style="width: 14%; text-align: center;">Participation</th>
                    <th>Derni√®re pr√©sence</th>
                    {% if user.is_authenticated %}
                        <th style="width: 14%; text-align: center;">Actions</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for licencie in licencies %}
                    <tr>
                        <td>{{ licencie.nom }}</td>
                        <td>{{ licencie.prenom }}</td>
                        <td>{{ licencie.grade }}</td>
                        <td style="text-align: center;">{{ licencie.nb_presences }}</td>
                        <td>
                            {% if licencie.last_session_date %}
                                {{ licencie.last_session_date|date:"d/m/Y" }}
                            {% else %}
                                Aucune session
                            {% endif %}
                        </td>
                        {% if user.is_authenticated %}
                            <td style="text-align: center;">
                                <a href="{% url 'modifier_licencie' licencie.id %}" class="btn-icon btn-edit" title="Modifier">‚úèÔ∏è</a>

                                <form action="{% url 'supprimer_licencie' licencie.id %}" method="post" style="display:inline;">
                                    {% csrf_token %}
                                    <button type="submit" class="btn-icon btn-delete" title="Supprimer" onclick="return confirm('Voulez-vous vraiment supprimer ce licenci√© ?');">‚ùå</button>
                                </form>
                            </td>
                        {% endif %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>Aucun licenci√© trouv√©.</p>
    {% endif %}
</div>
{% endblock %}
