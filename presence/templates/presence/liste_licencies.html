{% extends "presence/base.html" %}

{% load static %}

{% block title %}Liste des licenci√©s{% endblock %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'presence/mobile/liste_licencies.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <div class="header-row">
        <h2>üë• Liste des licenci√©s</h2>
        <div class="header-actions">
            <a href="{% url 'ajouter_licencie' %}" class="btn-submit btn-add" title="Ajouter un licenci√©">
                <span class="btn-icon">‚ûï</span>
                <span class="btn-text">Ajouter</span>
            </a>
            <a href="{% url 'export_licencies_excel' %}" class="btn-submit btn-export" title="Exporter la liste">
                <span class="btn-icon">üì•</span>
                <span class="btn-text">Exporter</span>
            </a>
        </div>
    </div>

    {% if licencies %}
        <!-- Version bureau/tablette -->
        <div class="table-container desktop-view">
            <table class="styled-table">
                <thead>
                    <tr>
                        <th>Nom</th>
                        <th>Pr√©nom</th>
                        <th>Grade</th>
                        <th>Participation</th>
                        <th>Derni√®re pr√©sence</th>
                        {% if user.is_authenticated %}
                            <th>Actions</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for licencie in licencies %}
                        <tr>
                            <td>{{ licencie.nom }}</td>
                            <td>{{ licencie.prenom }}</td>
                            <td>{{ licencie.grade }}</td>
                            <td>{{ licencie.nb_presences }}</td>
                            <td>
                                {% if licencie.last_session_date %}
                                    {{ licencie.last_session_date|date:"d/m/Y" }}
                                {% else %}
                                    &mdash;
                                {% endif %}
                            </td>
                            {% if user.is_authenticated %}
                                <td>
                                    <div class="actions-group">
                                        <form action="{% url 'modifier_licencie' licencie.id %}" method="get" style="display:inline;">
                                            <button type="submit" class="btn-icon btn-edit" title="Modifier">
                                                <span aria-hidden="true">‚úèÔ∏è</span>
                                                <span class="sr-only">Modifier</span>
                                            </button>
                                        </form>
                                        <form action="{% url 'supprimer_licencie' licencie.id %}" method="get" style="display:inline;">
                                            <button type="submit" class="btn-icon btn-delete" title="Supprimer">
                                                <span aria-hidden="true">‚ùå</span>
                                                <span class="sr-only">Supprimer</span>
                                            </button>
                                        </form>
                                    </div>
                                </td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Version mobile -->
        <div class="mobile-view">
            {% for licencie in licencies %}
                <div class="licencie-card">
                    <div class="card-header">
                        <strong>{{ licencie.nom }} {{ licencie.prenom }}</strong>
                        <span class="grade-badge">{{ licencie.grade }}</span>
                    </div>
                    <div class="card-info">
                        <div>
                            <span class="info-label">Participation :</span>
                            <span class="info-value">{{ licencie.nb_presences }}</span>
                        </div>
                        <div>
                            <span class="info-label">Derni√®re pr√©sence :</span>
                            <span class="info-value">
                                {% if licencie.last_session_date %}
                                    {{ licencie.last_session_date|date:"d/m/Y" }}
                                {% else %}
                                    &mdash;
                                {% endif %}
                            </span>
                        </div>
                    </div>
                    {% if user.is_authenticated %}
                        <div class="card-actions">
                            <a href="{% url 'modifier_licencie' licencie.id %}" class="btn-mobile btn-edit-mobile" title="Modifier">‚úèÔ∏è Modifier</a>
                            <form action="{% url 'supprimer_licencie' licencie.id %}" method="get" style="display:inline;">
                                <button type="submit" class="btn-mobile btn-delete-mobile" title="Supprimer">‚ùå Supprimer</button>
                            </form>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="no-data">
            <p>Aucun licenci√© trouv√©.</p>
        </div>
    {% endif %}
</div>
{% endblock %}
