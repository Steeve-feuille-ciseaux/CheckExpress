{% extends 'presence/base.html' %}

{% load static %}

{% block title %}Utilisateurs{% endblock %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'presence/mobile/parametre.css' %}?v=1">
{% endblock %}

{% block content %}
<div class="mobile-users">
    <!-- En-tÃªte de page -->
    <div class="page-header">
        <h2 class="page-title">ğŸ‘¥ Liste des utilisateurs</h2>
    </div>

    <!-- Statistiques -->
    {% if users %}
    <div class="users-stats">
        <p class="stats-number">{{ users|length }}</p>
        <p class="stats-label">utilisateur{{ users|length|pluralize }} au total</p>
    </div>
    {% endif %}

    <!-- Boutons d'action -->
    <div class="action-buttons">
        <a href="{% url 'gestion_ville' %}" class="action-btn">
            <span class="action-btn-icon">ğŸ™ï¸</span>
            Ville
        </a>
        <a href="{% url 'gestion_etablissement' %}" class="action-btn">
            <span class="action-btn-icon">ğŸ¢</span>
            Ã‰tablissement
        </a>
        <a href="{% url 'gestion_role' %}" class="action-btn">
            <span class="action-btn-icon">ğŸ‘”</span>
            RÃ´le
        </a>
    </div>

    <!-- Liste des utilisateurs -->
    {% if users %}
        <div class="users-grid">
            {% for user in users %}
                {% if user != request.user %}
                    <div class="user-card">
                        <!-- En-tÃªte utilisateur -->
                        <div class="user-header">
                            <h3 class="user-name">{{ user.username }}</h3>
                            <p class="user-email">{{ user.email|default:"Pas d'email" }}</p>
                        </div>

                        <!-- Informations utilisateur -->
                        <div class="user-content">
                            <div class="user-info">
                                <!-- RÃ´les -->
                                <div class="info-item">
                                    <span class="info-icon">ğŸ‘”</span>
                                    <div class="info-content">
                                        <div class="info-label">RÃ´le(s)</div>
                                        <div class="role-badges">
                                            {% for group in user.groups.all %}
                                                <span class="role-badge">{{ group.name }}</span>
                                            {% empty %}
                                                <span class="role-badge empty">Aucun rÃ´le</span>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>

                                <!-- Ã‰tablissement -->
                                <div class="info-item">
                                    <span class="info-icon">ğŸ¢</span>
                                    <div class="info-content">
                                        <div class="info-label">Ã‰tablissement</div>
                                        <div class="info-value{% if not user.profile.etablissement %} empty{% endif %}">
                                            {{ user.profile.etablissement.name|default:"Non dÃ©fini" }}
                                        </div>
                                    </div>
                                </div>

                                <!-- Ville -->
                                <div class="info-item">
                                    <span class="info-icon">ğŸ™ï¸</span>
                                    <div class="info-content">
                                        <div class="info-label">Ville</div>
                                        <div class="info-value{% if not user.profile.etablissement.ville %} empty{% endif %}">
                                            {{ user.profile.etablissement.ville.name|default:"Non dÃ©fini" }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Actions -->
                        <div class="user-actions">
                            <a href="{% url 'user_detail' user.id %}" class="user-action-btn btn-view">
                                <span>ğŸ‘ï¸</span>
                                Voir
                            </a>
                            <a href="{% url 'user_edit' user.id %}" class="user-action-btn btn-edit">
                                <span>âœï¸</span>
                                Modifier
                            </a>
                            <a href="{% url 'user_delete' user.id %}" class="user-action-btn btn-delete">
                                <span>ğŸ—‘ï¸</span>
                                Supprimer
                            </a>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    {% else %}
        <div class="no-users-container">
            <div class="no-users-icon">ğŸ‘¤</div>
            <h3 class="no-users-title">Aucun utilisateur trouvÃ©</h3>
            <p class="no-users-text">Il n'y a actuellement aucun utilisateur dans le systÃ¨me.</p>
        </div>
    {% endif %}
</div>
{% endblock %}